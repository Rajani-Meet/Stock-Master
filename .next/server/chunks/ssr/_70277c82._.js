module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},77156,81560,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>c],77156);let d=(0,b.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);a.s(["Trash2",()=>d],81560)},24669,a=>{"use strict";let b=(0,a.i(70106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],24669)},18603,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(54161),g=a.i(87682),h=a.i(15618),i=a.i(65385),j=a.i(77156),k=a.i(24669);let l=(0,a.i(70106).default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var m=a.i(65733),n=a.i(5522),o=a.i(17171),p=a.i(97895);function q({className:a,...c}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,p.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...c})}var r=a.i(81560);function s({open:a,onClose:d,onSuccess:f}){let[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[p,s]=(0,c.useState)({type:"PHYSICAL_COUNT",locationId:"",reason:"",notes:"",items:[{productId:"",currentQty:0,adjustedQty:0}]}),[t,u]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&Promise.all([fetch("/api/locations").then(a=>a.json()),fetch("/api/products").then(a=>a.json())]).then(([a,b])=>{j(a.data||[]),l(b.data||[])})},[a]);let v=(a,b,c)=>{let d=[...p.items];d[a]={...d[a],[b]:c},s({...p,items:d})},w=async a=>{a.preventDefault(),u(!0);try{(await fetch("/api/adjustments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok&&(f(),d(),s({type:"PHYSICAL_COUNT",locationId:"",reason:"",notes:"",items:[{productId:"",currentQty:0,adjustedQty:0}]}))}catch(a){console.error("Failed to create adjustment:",a)}finally{u(!1)}};return(0,b.jsx)(m.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(m.DialogContent,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsx)(m.DialogHeader,{children:(0,b.jsx)(m.DialogTitle,{children:"Stock Adjustment"})}),(0,b.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(o.Label,{children:"Type"}),(0,b.jsxs)(g.Select,{value:p.type,onValueChange:a=>s({...p,type:a}),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"PHYSICAL_COUNT",children:"Physical Count"}),(0,b.jsx)(g.SelectItem,{value:"DAMAGE",children:"Damage"}),(0,b.jsx)(g.SelectItem,{value:"LOSS",children:"Loss"}),(0,b.jsx)(g.SelectItem,{value:"GAIN",children:"Gain"}),(0,b.jsx)(g.SelectItem,{value:"EXPIRY",children:"Expiry"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(o.Label,{children:"Location"}),(0,b.jsxs)(g.Select,{value:p.locationId,onValueChange:a=>s({...p,locationId:a}),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Select location"})}),(0,b.jsx)(g.SelectContent,{children:i.map(a=>(0,b.jsx)(g.SelectItem,{value:a.id,children:a.name},a.id))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(o.Label,{children:"Reason"}),(0,b.jsx)(n.Input,{value:p.reason,onChange:a=>s({...p,reason:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)(o.Label,{children:"Items"}),(0,b.jsx)(e.Button,{type:"button",size:"sm",onClick:()=>{s({...p,items:[...p.items,{productId:"",currentQty:0,adjustedQty:0}]})},children:(0,b.jsx)(h.Plus,{className:"w-4 h-4"})})]}),p.items.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-2",children:[(0,b.jsx)("div",{className:"col-span-6",children:(0,b.jsxs)(g.Select,{value:a.productId,onValueChange:a=>v(c,"productId",a),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{placeholder:"Product"})}),(0,b.jsx)(g.SelectContent,{children:k.map(a=>(0,b.jsx)(g.SelectItem,{value:a.id,children:a.name},a.id))})]})}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)(n.Input,{type:"number",placeholder:"Current",value:a.currentQty,onChange:a=>v(c,"currentQty",+a.target.value)})}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)(n.Input,{type:"number",placeholder:"Adjusted",value:a.adjustedQty,onChange:a=>v(c,"adjustedQty",+a.target.value)})}),(0,b.jsx)("div",{className:"col-span-1",children:(0,b.jsx)("span",{className:"text-sm font-medium",children:a.adjustedQty-a.currentQty})}),(0,b.jsx)("div",{className:"col-span-1",children:(0,b.jsx)(e.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{s({...p,items:p.items.filter((a,b)=>b!==c)})},children:(0,b.jsx)(r.Trash2,{className:"w-4 h-4"})})})]},c))]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(o.Label,{children:"Notes"}),(0,b.jsx)(q,{value:p.notes,onChange:a=>s({...p,notes:a.target.value})})]}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:t,children:"Create Adjustment"})]})]})]})})}function t(){let[a,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)(!1),[r,t]=(0,c.useState)("all"),[u,v]=(0,c.useState)([]),w=async()=>{try{let a=new URLSearchParams;"all"!==r&&a.append("type",r);let b=await fetch(`/api/adjustments?${a}`),c=await b.json();m(c.adjustments||[])}catch(a){console.error("Failed to fetch adjustments:",a),m([])}finally{o(!1)}},x=async()=>{try{let a=await fetch("/api/locations"),b=await a.json();v(b.data||[])}catch(a){console.error("Failed to fetch locations:",a)}};return(0,c.useEffect)(()=>{x()},[]),(0,c.useEffect)(()=>{w()},[r]),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Stock Adjustments"}),(0,b.jsxs)(e.Button,{className:"gap-2",onClick:()=>q(!0),children:[(0,b.jsx)(h.Plus,{className:"w-4 h-4"}),"Create Adjustment"]})]}),(0,b.jsx)(s,{open:p,onClose:()=>q(!1),onSuccess:w}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[(0,b.jsxs)(g.Select,{value:r,onValueChange:t,children:[(0,b.jsx)(g.SelectTrigger,{className:"w-48",children:(0,b.jsx)(g.SelectValue,{placeholder:"All Types"})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"all",children:"All Types"}),(0,b.jsx)(g.SelectItem,{value:"PHYSICAL_COUNT",children:"Physical Count"}),(0,b.jsx)(g.SelectItem,{value:"DAMAGE",children:"Damage"}),(0,b.jsx)(g.SelectItem,{value:"LOSS",children:"Loss"}),(0,b.jsx)(g.SelectItem,{value:"GAIN",children:"Gain"}),(0,b.jsx)(g.SelectItem,{value:"EXPIRY",children:"Expiry"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,b.jsxs)(f.Badge,{variant:"outline",children:["Total: ",a.length]}),(0,b.jsxs)(f.Badge,{variant:"success",children:["Gains: ",a.filter(a=>"GAIN"===a.type).length]}),(0,b.jsxs)(f.Badge,{variant:"warning",children:["Losses: ",a.filter(a=>["DAMAGE","LOSS","EXPIRY"].includes(a.type)).length]})]})]})}),(0,b.jsx)(d.CardContent,{children:n?(0,b.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"Loading adjustments..."}):0===a.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(i.Settings2,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No adjustments found"})]}):(0,b.jsx)("div",{className:"space-y-3",children:a.map(a=>{let c,d=(c=a.items,c?.reduce((a,b)=>a+(b.adjustedQty-b.currentQty),0)||0);return(0,b.jsxs)("div",{className:"p-4 rounded-lg border border-border hover:bg-foreground/5 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(i.Settings2,{className:"w-5 h-5 text-primary"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.adjustmentNo}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.reason}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:u.find(b=>b.id===a.locationId)?.name})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[d>0?(0,b.jsx)(k.TrendingUp,{className:"w-4 h-4 text-success"}):d<0?(0,b.jsx)(l,{className:"w-4 h-4 text-destructive"}):null,(0,b.jsxs)("span",{className:`text-sm font-medium ${d>0?"text-success":d<0?"text-destructive":"text-muted-foreground"}`,children:[d>0?"+":"",d]})]}),(0,b.jsx)(f.Badge,{variant:{PHYSICAL_COUNT:"secondary",DAMAGE:"destructive",LOSS:"warning",GAIN:"success",EXPIRY:"outline"}[a.type]||"secondary",children:a.type.replace("_"," ")}),(0,b.jsx)(e.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(j.Eye,{className:"w-4 h-4"})})]})]}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Items Adjusted"}),(0,b.jsx)("p",{className:"font-medium",children:a.items?.length||0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Net Change"}),(0,b.jsxs)("p",{className:`font-medium ${d>0?"text-success":d<0?"text-destructive":""}`,children:[d>0?"+":"",d," units"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Adjustment Date"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(a.adjustmentDate).toLocaleDateString()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Created By"}),(0,b.jsx)("p",{className:"font-medium",children:a.createdBy?.name||"System"})]})]}),a.notes&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-muted/50 rounded text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Notes: "}),a.notes]})]},a.id)})})})]})]})}a.s(["default",()=>t],18603)}];

//# sourceMappingURL=_70277c82._.js.map