module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},81464,a=>{"use strict";let b=(0,a.i(70106).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);a.s(["Filter",()=>b],81464)},77156,81560,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>c],77156);let d=(0,b.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);a.s(["Trash2",()=>d],81560)},55087,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(87682),i=a.i(81464),j=a.i(62213),j=j;function k({onFilter:a,type:k}){let[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)({status:"all",warehouseId:"all",categoryId:"all",dateFrom:"",dateTo:""});return((0,c.useEffect)(()=>{Promise.all([fetch("/api/warehouses").then(a=>a.json()),fetch("/api/categories").then(a=>a.json())]).then(([a,b])=>{o(a.data||[]),q(b.data||[])})},[]),l)?(0,b.jsxs)(d.Card,{className:"w-full max-w-md",children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm",children:"Filters"}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>m(!1),children:(0,b.jsx)(j.default,{className:"w-4 h-4"})})]}),(0,b.jsxs)(d.CardContent,{className:"space-y-4",children:["products"!==k&&(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Status"}),(0,b.jsxs)(h.Select,{value:r.status,onValueChange:a=>s({...r,status:a}),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{placeholder:"All statuses"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"All"}),(()=>{switch(k){case"receipts":return["DRAFT","WAITING","VALIDATED","CANCELLED"];case"deliveries":return["DRAFT","READY","DONE","CANCELLED"];case"transfers":return["DRAFT","WAITING","READY","DONE","CANCELLED"];default:return[]}})().map(a=>(0,b.jsx)(h.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Warehouse"}),(0,b.jsxs)(h.Select,{value:r.warehouseId,onValueChange:a=>s({...r,warehouseId:a}),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{placeholder:"All warehouses"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"All"}),n.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Category"}),(0,b.jsxs)(h.Select,{value:r.categoryId,onValueChange:a=>s({...r,categoryId:a}),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{placeholder:"All categories"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"All"}),p.map(a=>(0,b.jsx)(h.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"From Date"}),(0,b.jsx)(f.Input,{type:"date",value:r.dateFrom,onChange:a=>s({...r,dateFrom:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"To Date"}),(0,b.jsx)(f.Input,{type:"date",value:r.dateTo,onChange:a=>s({...r,dateTo:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{onClick:()=>{a(Object.fromEntries(Object.entries(r).filter(([a,b])=>""!==b&&"all"!==b))),m(!1)},className:"flex-1",children:"Apply"}),(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{s({status:"all",warehouseId:"all",categoryId:"all",dateFrom:"",dateTo:""}),a({})},children:"Clear"})]})]})]}):(0,b.jsxs)(e.Button,{variant:"outline",onClick:()=>m(!0),className:"gap-2",children:[(0,b.jsx)(i.Filter,{className:"w-4 h-4"}),"Filters"]})}a.s(["default",()=>k],55087)},88519,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(54161),g=a.i(15618),h=a.i(83497),i=a.i(77156),j=a.i(65733),k=a.i(5522),l=a.i(17171),m=a.i(87682),n=a.i(81560);function o({open:a,onClose:d,onSuccess:f}){let[h,i]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)({supplierName:"",warehouseId:"",receivedDate:new Date().toISOString().split("T")[0],notes:"",items:[{productId:"",quantity:1,unitPrice:0}]}),[s,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&Promise.all([fetch("/api/warehouses").then(a=>a.json()),fetch("/api/products").then(a=>a.json())]).then(([a,b])=>{i(a||[]),p(b.data||[])})},[a]);let u=(a,b,c)=>{let d=[...q.items];d[a]={...d[a],[b]:c},r({...q,items:d})},v=async a=>{if(a.preventDefault(),!q.supplierName||!q.warehouseId)return void alert("Please fill in supplier name and warehouse");let b=q.items.filter(a=>a.productId&&a.quantity>0);if(0===b.length)return void alert("Please add at least one valid item");t(!0);try{let a=await fetch("/api/receipts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...q,items:b})});if(a.ok)f(),d(),r({supplierName:"",warehouseId:"",receivedDate:new Date().toISOString().split("T")[0],notes:"",items:[{productId:"",quantity:1,unitPrice:0}]});else{let b=await a.json();alert(b.error||"Failed to create receipt")}}catch(a){console.error("Failed to create receipt:",a),alert("Network error. Please try again.")}finally{t(!1)}};return(0,b.jsx)(j.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,b.jsx)(j.DialogHeader,{children:(0,b.jsx)(j.DialogTitle,{children:"Create Receipt"})}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Supplier Name"}),(0,b.jsx)(k.Input,{value:q.supplierName,onChange:a=>r({...q,supplierName:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Warehouse"}),(0,b.jsxs)(m.Select,{value:q.warehouseId,onValueChange:a=>r({...q,warehouseId:a}),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Select warehouse"})}),(0,b.jsx)(m.SelectContent,{children:h.map(a=>(0,b.jsx)(m.SelectItem,{value:a.id,children:a.name},a.id))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Received Date"}),(0,b.jsx)(k.Input,{type:"date",value:q.receivedDate,onChange:a=>r({...q,receivedDate:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)(l.Label,{children:"Items"}),(0,b.jsx)(e.Button,{type:"button",size:"sm",onClick:()=>{r({...q,items:[...q.items,{productId:"",quantity:1,unitPrice:0}]})},children:(0,b.jsx)(g.Plus,{className:"w-4 h-4"})})]}),q.items.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 mb-2",children:[(0,b.jsx)("div",{className:"col-span-5",children:(0,b.jsxs)(m.Select,{value:a.productId,onValueChange:a=>u(c,"productId",a),children:[(0,b.jsx)(m.SelectTrigger,{children:(0,b.jsx)(m.SelectValue,{placeholder:"Product"})}),(0,b.jsx)(m.SelectContent,{children:o.map(a=>(0,b.jsx)(m.SelectItem,{value:a.id,children:a.name},a.id))})]})}),(0,b.jsx)("div",{className:"col-span-3",children:(0,b.jsx)(k.Input,{type:"number",placeholder:"Qty",value:a.quantity,onChange:a=>u(c,"quantity",+a.target.value)})}),(0,b.jsx)("div",{className:"col-span-3",children:(0,b.jsx)(k.Input,{type:"number",step:"0.01",placeholder:"Price",value:a.unitPrice,onChange:a=>u(c,"unitPrice",+a.target.value)})}),(0,b.jsx)("div",{className:"col-span-1",children:(0,b.jsx)(e.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{r({...q,items:q.items.filter((a,b)=>b!==c)})},children:(0,b.jsx)(n.Trash2,{className:"w-4 h-4"})})})]},c))]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Notes"}),(0,b.jsx)(k.Input,{value:q.notes,onChange:a=>r({...q,notes:a.target.value})})]}),(0,b.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,b.jsx)(e.Button,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),(0,b.jsx)(e.Button,{type:"submit",disabled:s,children:"Create Receipt"})]})]})]})})}var p=a.i(55087);function q(){let[a,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)({}),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)([]),u=async()=>{try{let a=new URLSearchParams;Object.entries(m).forEach(([b,c])=>{c&&a.append(b,c)});let b=await fetch(`/api/receipts?${a}`),c=await b.json();j(c.receipts||[])}catch(a){console.error("Failed to fetch receipts:",a),j([])}finally{l(!1)}},v=async()=>{try{let a=await fetch("/api/warehouses"),b=await a.json();t(b.data||[])}catch(a){console.error("Failed to fetch warehouses:",a)}};(0,c.useEffect)(()=>{v()},[]),(0,c.useEffect)(()=>{u()},[m]);let w=async(a,b)=>{try{(await fetch("/api/receipts",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({receiptId:a,status:b})})).ok&&u()}catch(a){console.error("Failed to update receipt status:",a)}},x=a=>({DRAFT:"WAITING",WAITING:"VALIDATED"})[a];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Receipts"}),(0,b.jsxs)(e.Button,{className:"gap-2",onClick:()=>r(!0),children:[(0,b.jsx)(g.Plus,{className:"w-4 h-4"}),"Create Receipt"]})]}),(0,b.jsx)(o,{open:q,onClose:()=>r(!1),onSuccess:u}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[(0,b.jsx)(p.default,{onFilter:n,type:"receipts"}),(0,b.jsxs)("div",{className:"flex gap-2 ml-auto",children:[(0,b.jsxs)(f.Badge,{variant:"outline",children:["Total: ",a.length]}),(0,b.jsxs)(f.Badge,{variant:"secondary",children:["Draft: ",a.filter(a=>"DRAFT"===a.status).length]}),(0,b.jsxs)(f.Badge,{variant:"warning",children:["Waiting: ",a.filter(a=>"WAITING"===a.status).length]}),(0,b.jsxs)(f.Badge,{variant:"success",children:["Validated: ",a.filter(a=>"VALIDATED"===a.status).length]})]})]})}),(0,b.jsx)(d.CardContent,{children:k?(0,b.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"Loading receipts..."}):0===a.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(h.Package,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No receipts found"})]}):(0,b.jsx)("div",{className:"space-y-3",children:a.map(a=>(0,b.jsxs)("div",{className:"p-4 rounded-lg border border-border hover:bg-foreground/5 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(h.Package,{className:"w-5 h-5 text-primary"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.receiptNo}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.supplierName}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:s.find(b=>b.id===a.warehouseId)?.name})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(f.Badge,{variant:{DRAFT:"secondary",WAITING:"warning",VALIDATED:"success",CANCELLED:"destructive"}[a.status]||"secondary",children:a.status}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)(e.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(i.Eye,{className:"w-4 h-4"})}),x(a.status)&&(0,b.jsx)(e.Button,{size:"sm",onClick:()=>w(a.id,x(a.status)),children:"WAITING"===x(a.status)?"Submit":"Validate"})]})]})]}),(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Items"}),(0,b.jsx)("p",{className:"font-medium",children:a.items?.length||0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Total Value"}),(0,b.jsxs)("p",{className:"font-medium",children:["$",a.items?.reduce((a,b)=>a+b.quantity*b.unitPrice,0).toFixed(2)||"0.00"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Received Date"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(a.receivedDate).toLocaleDateString()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(a.createdAt).toLocaleDateString()})]})]}),a.notes&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-muted/50 rounded text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Notes: "}),a.notes]})]},a.id))})})]})]})}a.s(["default",()=>q],88519)}];

//# sourceMappingURL=_7d731ed3._.js.map