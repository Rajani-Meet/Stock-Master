{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///E:/Stock%20Master/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\n\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\n\nexport const db =\n  globalForPrisma.prisma ||\n  new PrismaClient({\n    log: [\"query\", \"error\"],\n  })\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = db\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AAEC,MAAM,KACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;QAAS;KAAQ;AACzB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///E:/Stock%20Master/lib/auth.ts"],"sourcesContent":["import { hash, compare } from \"bcryptjs\"\nimport { cookies } from \"next/headers\"\n\nexport async function hashPassword(password: string): Promise<string> {\n  return hash(password, 10)\n}\n\nexport async function comparePassword(password: string, hashedPassword: string): Promise<boolean> {\n  return compare(password, hashedPassword)\n}\n\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\n  return compare(password, hashedPassword)\n}\n\nexport function generateOTP(): string {\n  return Math.floor(100000 + Math.random() * 900000).toString()\n}\n\nexport function generateResetToken(): string {\n  return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15)\n}\n\nexport async function getCurrentUser() {\n  const cookieStore = await cookies()\n  const authToken = cookieStore.get(\"auth_token\")\n  \n  if (!authToken) {\n    return null\n  }\n  \n  try {\n    const decoded = JSON.parse(Buffer.from(authToken.value, \"base64\").toString())\n    return decoded\n  } catch {\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,IAAA,2IAAI,EAAC,UAAU;AACxB;AAEO,eAAe,gBAAgB,QAAgB,EAAE,cAAsB;IAC5E,OAAO,IAAA,8IAAO,EAAC,UAAU;AAC3B;AAEO,eAAe,eAAe,QAAgB,EAAE,cAAsB;IAC3E,OAAO,IAAA,8IAAO,EAAC,UAAU;AAC3B;AAEO,SAAS;IACd,OAAO,KAAK,KAAK,CAAC,SAAS,KAAK,MAAM,KAAK,QAAQ,QAAQ;AAC7D;AAEO,SAAS;IACd,OAAO,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG,MAAM,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG;AAC/F;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,YAAY,YAAY,GAAG,CAAC;IAElC,IAAI,CAAC,WAAW;QACd,OAAO;IACT;IAEA,IAAI;QACF,MAAM,UAAU,KAAK,KAAK,CAAC,OAAO,IAAI,CAAC,UAAU,KAAK,EAAE,UAAU,QAAQ;QAC1E,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///E:/Stock%20Master/app/api/users/route.ts"],"sourcesContent":["import { db } from \"@/lib/db\"\nimport { hashPassword } from \"@/lib/auth\"\nimport { type NextRequest, NextResponse } from \"next/server\"\n\nexport async function GET(req: NextRequest) {\n  try {\n    const { searchParams } = new URL(req.url)\n    const role = searchParams.get(\"role\")\n    const isActive = searchParams.get(\"isActive\")\n    const search = searchParams.get(\"search\")\n\n    const where: any = {}\n    if (role) where.role = role\n    if (isActive !== null) where.isActive = isActive === \"true\"\n    if (search) {\n      where.OR = [\n        { name: { contains: search, mode: \"insensitive\" } },\n        { email: { contains: search, mode: \"insensitive\" } }\n      ]\n    }\n\n    const users = await db.user.findMany({\n      where,\n      select: {\n        id: true,\n        name: true,\n        email: true,\n        role: true,\n        isActive: true,\n        lastLoginAt: true,\n        createdAt: true,\n      },\n      orderBy: { createdAt: \"desc\" },\n    })\n\n    return NextResponse.json({ data: users })\n  } catch (error) {\n    return NextResponse.json({ error: \"Failed to fetch users\" }, { status: 500 })\n  }\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { name, email, role, password } = await req.json()\n\n    if (!name || !email || !role || !password) {\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\n    }\n\n    const existingUser = await db.user.findUnique({ where: { email } })\n    if (existingUser) {\n      return NextResponse.json({ error: \"User already exists\" }, { status: 400 })\n    }\n\n    const hashedPassword = await hashPassword(password)\n\n    const user = await db.user.create({\n      data: { name, email, role, password: hashedPassword },\n      select: { id: true, name: true, email: true, role: true, isActive: true, createdAt: true }\n    })\n\n    return NextResponse.json({ data: user }, { status: 201 })\n  } catch (error) {\n    return NextResponse.json({ error: \"Failed to create user\" }, { status: 500 })\n  }\n}\n\nexport async function PUT(req: NextRequest) {\n  try {\n    const { userId, name, email, role, isActive, password } = await req.json()\n\n    if (!userId) {\n      return NextResponse.json({ error: \"User ID required\" }, { status: 400 })\n    }\n\n    const updateData: any = {}\n    if (name) updateData.name = name\n    if (email) updateData.email = email\n    if (role) updateData.role = role\n    if (typeof isActive === \"boolean\") updateData.isActive = isActive\n    if (password) updateData.password = await hashPassword(password)\n\n    const user = await db.user.update({\n      where: { id: userId },\n      data: updateData,\n      select: { id: true, name: true, email: true, role: true, isActive: true, createdAt: true }\n    })\n\n    return NextResponse.json({ data: user })\n  } catch (error) {\n    return NextResponse.json({ error: \"Failed to update user\" }, { status: 500 })\n  }\n}"],"names":[],"mappings":"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"}}]
}